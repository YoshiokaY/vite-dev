@use "../../abstracts" as *;
@use "sass:math";

///-----------------フロー//

.c_flow {
  position: relative;
  display: flex;
  gap: 0 0.7rem;
  justify-content: flex-start;
  width: 100%;
  padding: 0 0 calc(1.9rem + 1.6rem);
  margin: auto;
  @include mq() {
    flex-wrap: wrap;
    gap: spSize(12) 0;
    padding: 0 0 0 spSize(18 + 12);
  }

  &_item {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 8rem;
    clip-path: polygon(92% 0%, 100% 50%, 92% 100%, 0 100%, 0 0);
    font-weight: bold;
    line-height: calc(24 / 20);
    color: $color-reversal;
    text-align: center;
    background-color: $color-prime;
    border-radius: 0.3rem;
    @include fontsize(20, 16);
    @include mq() {
      height: spSize(77);
      clip-path: polygon(0 0, 100% 0, 100% 70%, 50% 100%, 0% 70%);
      line-height: calc(21 / 16);
    }
  }

  &::before,
  &::after {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    margin: auto;
    content: "";
  }

  &::before {
    bottom: 0.7rem;
    height: 0.2rem;
    background-color: $color-prime;
    @include mq() {
      bottom: 0;
      left: spSize(5);
      width: 0.2rem;
      height: 100%;
    }
  }

  &::after {
    height: 1.6rem;
    border: 0.2rem solid $color-prime;
    border-width: 0 0.2rem;
    @include mq() {
      width: spSize(12);
      height: 100%;
      border-width: 0.2rem 0;
    }
  }
}

.c_flowList {
  counter-reset: number 0;

  &_item {
    position: relative;
    padding: pcSize(24);
    background-color: $bgHighlight;
    border-radius: 1.7rem;
    @include mq() {
      padding: spSize(24) spSize(12);
      border-radius: spSize(8);
    }

    &:not(:last-child) {
      margin-bottom: 5.6rem;
      @include mq() {
        margin-bottom: spSize(40);
      }

      &::after {
        position: absolute;
        right: 0;
        bottom: calc(-1.6rem - 2.4rem);
        left: 0;
        width: 12rem;
        height: 2.4rem;
        margin: auto;
        content: "";
        background-image: url("data:image/svg+xml;charset=utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22120%22%20height%3D%2224%22%20viewBox%3D%220%200%20120%2024%22%3E%20%3Cpath%20id%3D%22%E5%A4%9A%E8%A7%92%E5%BD%A2_37%22%20data-name%3D%22%E5%A4%9A%E8%A7%92%E5%BD%A2%2037%22%20d%3D%22M59.257.3a2%2C2%2C0%2C0%2C1%2C1.486%2C0l49.615%2C19.846A2%2C2%2C0%2C0%2C1%2C109.615%2C24H10.385a2%2C2%2C0%2C0%2C1-.743-3.857Z%22%20transform%3D%22translate(120%2024)%20rotate(180)%22%20fill%3D%22%23d7063c%22%2F%3E%3C%2Fsvg%3E");
        background-repeat: no-repeat;
        background-position: center;
        background-size: 100% 100%;
        @include mq() {
          bottom: -8vw;
          width: spSize(64);
          height: spSize(16);
        }
      }
    }
  }

  &_ttl {
    > span {
      position: relative;
      padding-right: 3.2rem;
      margin-right: 1.1rem;
      @include mq() {
        padding-right: spSize(25);
        margin-right: spSize(20);
      }

      &::before {
        color: $color-prime;
        content: "STEP." counter(number, decimal-leading-zero);
        counter-increment: number 1;
      }

      &::after {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        width: 2rem;
        height: 0.2rem;
        margin: auto;
        content: "";
        background-color: $color-prime;
        @include mq() {
          width: spSize(16);
        }
      }
    }
  }
}

.flowWrapper {
  width: 100%;
  padding: 0;
  margin: auto;
  counter-reset: number 0;

  > .flowContents {
    position: relative;
    display: block;
    padding: 0;
    margin: 10px auto 50px;

    &:last-child {
      margin: 10px auto;
    }

    &:not(:last-child)::after {
      position: absolute;
      right: 0;
      bottom: -40px;
      left: 0;
      display: block;
      width: 0;
      height: 0;
      margin: auto;
      content: "";
      border-color: $color-prime transparent transparent transparent;
      border-style: solid;
      border-width: 30px 25px 0;
    }
  }
}

.flowTitle {
  span {
    margin-right: 0.5em;
    font-size: 1.8rem;
    line-height: 1;
    color: $color-prime;
    letter-spacing: 0;
    vertical-align: baseline;

    &::after {
      content: "0" counter(number);
      counter-increment: number 1;
    }
  }
}

.flowWrapper.-horizontal {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;

  .flowContents {
    flex: 1;
    padding: 1.5em 1%;
    margin: 0;

    &:not(:last-child) {
      margin-right: 4%;

      &::after {
        inset: 0 -19% 0 auto;
        margin: auto;
        border-color: transparent transparent transparent $color-prime;
        border-width: 50.5px 0 50.5px 25px;
      }
    }
  }
}

@if $spMode == false {
  @include mq(sp) {
    .flowWrapper.-horizontal {
      display: block;

      .flowContents {
        display: block;
        width: 100%;
        margin: 10px auto;

        &:not(:last-child) {
          margin-right: auto;
          margin-bottom: 50px;

          &::after {
            position: absolute;
            inset: auto 0 -65px;
            display: block;
            content: "";
            transform: rotate(90deg);
          }
        }
      }
    }
  }
}
